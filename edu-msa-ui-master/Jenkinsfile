pipeline {
    agent any

    stages {
        stage('Checkout') {
            steps {
                git url: 'https://github.com/jeongbami/gitops-repository.git', branch: 'main'
            }
        }
        
        stage('Build and Push Image') {
            steps {
                script {
                    docker.build('seunghyejeong/project_cicd:2.0', '-f Dockerfile .')
                    withCredentials([usernamePassword(credentialsId: 'seunghyejeong', passwordVariable: 'tlqkfak0315!', usernameVariable: 'seunghyejeong')]) {
                        def image = docker.build("seunghyejeong/project_cicd:2.0")
                        docker.withRegistry('seunghyejeong/project_cicd:2.0', 'seunghyejeong') {
                            image.push()
                    }
                }
            }
        }
        
       } // Add additional stages for testing and deploying your application
    }
 }
